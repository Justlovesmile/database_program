<!DOCTYPE html>
<html lang="en">
<head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <meta http-equiv="X-UA-Compatible" content="ie=edge">
                <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
                <link rel="shortcut icon" href="/static/img/logo.png">
                <script type="text/javascript" src="/static/js/jquery-3.4.1.js"></script>
                <link rel="stylesheet" href="/static/css/base.css">
                <script type="text/javascript" src="/static/js/check_session.js"></script>
        <title>æœ€æ–°å¸–å­</title>
</head>
<body>
                <div class='header'>
                                <div class="menu">
                                    <div>
                                        <ul class="menubar" id="left_nav">
                                            <li class="menu-value" ><a class="navbar_img" style="font-weight:bold" href="/">
                                                <img src="/static/img/bbs.png" class="navbar_img"></a><li>
                                            <li class=""><a href="/"><span class="glyphicon glyphicon-home"></span> é¦–é¡µ</a></li>
                                            <li class="" ><a href="/newpost/"><span class="glyphicon glyphicon-time"></span> æœ€æ–°</a></li>
                                            <li class="" ><a href="/search/"><span class="glyphicon glyphicon-search"></span> æœç´¢</a></li>
                                            <li class="" ><a href="/introduce/"><span class="glyphicon glyphicon-info-sign"></span> è¯´æ˜</a></li>
                                        </ul>
                                        <ul class="menubar_right" id="right_nav">
                                            <li  id="session_check_nav"><a href='/login/'> ç™»é™†</a></li>
                                        </ul>
                                    </div>
                                </div>
                        </div>
    <div class="content">
        <div class="content_box">
            <div class='card'>
                <p style="text-align: center;font-size: 25px;"><strong>ğŸ‘‡æœ€æ–°å‘å¸–ğŸ‘‡</strong></p>
            </div>
            <div id="new_post">
                <! -- æœ€æ–°å¸–å­ -->
            </div>
        </div>
    </div>

    <script>
        comment=function(post_id){
            id='#'+post_id
            console.log('ç‚¹å‡»äº†'+id)
            comment_content=$(id).val()
            data={
                'post_id':post_id,
                'content':comment_content
            }
            $.post('/comment-content/',data,function(ans){
                if(ans=='nosession'){
                    alert("è¯·ç™»å½•åè¯„è®ºï¼")
                    return false
                }
                else{
                    if(ans=='ok'){
                        alert('è¯„è®ºæˆåŠŸï¼')
                    }
                    else{
                        alert('è¯„è®ºå¤±è´¥')
                        return false
                    }
                }
                
            })
        }

        get_post=function(){
            $.post('/get-post/',{},function(ans){
                all_lines = $.parseJSON(ans)
                //console.log(ans)
                for (index in all_lines){
                    each_line = all_lines[index]
                    //console.log(each_line)
                    author_id=each_line[0]
                    nickname=each_line[1]
                    post_id=each_line[2]
                    title=each_line[3]
                    content=each_line[4]
                    time=each_line[5]
                    $('#new_post').append("<div class='card'><a href='/newcomment/'><div style='padding:10px;background-color: #6fc2d0;'>"
                        +"<p style='font-size:20px;'><strong>"+title+"</strong></p>"
                        +"<p style='font-size:15px;overflow: hidden;text-overflow: ellipsis;display: -webkit-box;-webkit-line-clamp: 3;-webkit-box-orient: vertical;'>"+content+"</p>"
                        +"<p style='text-align:right;'><small>"+nickname+"</small></p>"
                        +"<p style='text-align:right;'><small>"+time+"</small></p></div></a>"
                        +"<textarea id='"+post_id+"' class='form-control' rows='1' style='max-width: 100%;min-width: 99.9999%;min-height: 35px;max-height:70px;' placeholder='æˆ‘è¦è¯„è®ºo(*ï¿£â–½ï¿£*)ãƒ–'></textarea>"
                        +"<div align='right' style='position:relative;bottom:10px;top:5px;'>"
                        +"<button id='commentBtn' class='btn btn-default' onclick='comment("+post_id+")'>è¯„è®º</button></div></div>");
                }
                if (all_lines.length == 0){
                    alert('æŸ¥è¯¢ç»“æœä¸ºç©º')
            }
            })
        }


        $(document).ready(function(){
            get_post()
        });
    </script>





    <div class="jumbotron text-center" style="margin-top:200px" id="footer">
            <p>å“ˆå°”æ»¨å·¥ç¨‹å¤§å­¦---æ•°æ®åº“è¯¾ç¨‹è®¾è®¡---2019</p>
    </div>
</body>
</html>